<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Cadastro — Meu Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./style.css" />
</head>
<body class="auth-bg">
  <div class="auth-card">
    <h1>Cadastro</h1>

    <form id="signupForm">
      <label>Nome completo</label>
      <input type="text" id="signupName" placeholder="Seu nome" required />

      <label>Nome de usuário</label>
      <input type="text" id="signupUsername" placeholder="ex.: joaosilva" required />

      <label>Telefone (opcional)</label>
      <input type="tel" id="signupPhone" placeholder="DDD+número (ex.: 27912345678)" />

      <label>E-mail</label>
      <input type="email" id="signupEmail" placeholder="seu@email.com" required />

      <label>Senha</label>
      <input type="password" id="signupPassword" placeholder="Crie uma senha" minlength="6" required />

      <button type="submit" class="btn-primary">Cadastrar</button>
    </form>

    <p class="auth-alt">
      Já tem conta? <a href="./index.html">Faça login</a>
    </p>
  </div>

  <script type="module" src="./app.js"></script>
  <script type="module">
    import { ensureLoggedOut, signUpWithEmail } from './app.js';
    ensureLoggedOut(); // Se já está logado, vai direto para o chat

    const form = document.getElementById('signupForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      await signUpWithEmail({
        name: document.getElementById('signupName').value.trim(),
        username: document.getElementById('signupUsername').value.trim().toLowerCase(),
        phone: document.getElementById('signupPhone').value.trim(),
        email: document.getElementById('signupEmail').value.trim(),
        password: document.getElementById('signupPassword').value,
      });
    });
  </script>
</body>
</html>
